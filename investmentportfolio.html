<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Stock Data Visualization</title>
  <!-- Include the Chart.js library -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <canvas id="stockChart"></canvas>

  <script>
    // API key for Alpha Vantage
    const apiKey = "R7ZJHMGHCNL0STMX";

    // Function to fetch stock data from Alpha Vantage API
    async function fetchStockData(symbol) {
      const apiUrl = `https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${symbol}&apikey=${apiKey}`;

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        return data['Time Series (Daily)'];
      } catch (error) {
        console.error("Error fetching stock data:", error);
        return null;
      }
    }

    // Function to transform stock data for chart
    function transformStockData(stockData) {
      const dates = [];
      const prices = [];

      for (const date in stockData) {
        const price = parseFloat(stockData[date]['4. close']);
        const formattedDate = new Date(date).toLocaleDateString('en-US');
        dates.unshift(formattedDate);
        prices.unshift(price);
      }

      return { dates, prices };
    }

    // Function to create stock chart
    function createStockChart(symbol, dates, prices) {
      const ctx = document.getElementById('stockChart').getContext('2d');

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: dates,
          datasets: [{
            label: `Stock Price (${symbol})`,
            data: prices,
            borderColor: 'blue',
            backgroundColor: 'rgba(0, 0, 255, 0.1)',
            fill: true,
          }]
        },
        options: {
          responsive: true,
          scales: {
            x: {
              display: true,
              title: {
                display: true,
                text: 'Date'
              }
            },
            y: {
              display: true,
              title: {
                display: true,
                text: 'Price'
              }
            }
          }
        }
      });
    }

    // Entry point
    async function main() {
      const stockSymbols = ['$BCRX', '$SDGR', '$BHP', '$SMR', '$UEC', '$DNN', '$NET', '$AKAM', '$SHOP', '$CYBR', '$MEG', '$HYLN', '$LCID', '$PSNY', '$RIVN', '$PLUG', '$BLDP', '$TTD', '$TCEHY', '$FSR', '$APPS', '$FUBO'];
      const purchases = [
        { symbol: '$BCRX', shares: 350, price: 2.42 },
        { symbol: '$SDGR', shares: 40, price: 30.41 },
        { symbol: '$BHP', shares: 20, price: 47.31 }
      ];

      // Fetch stock data and create charts for purchased stocks
      for (const purchase of purchases) {
        const { symbol, shares, price } = purchase;
        const stockData = await fetchStockData(symbol);

        if (stockData)
{
const { dates, prices } = transformStockData(stockData);
      // Calculate the total investment value over time
      const investmentValues = prices.map((price) => price * shares * price);

      // Create stock chart
      createStockChart(`${symbol} (${shares} shares)`, dates, investmentValues);
    }
  }

  // Fetch stock data and create charts for watchlist stocks
  for (const symbol of stockSymbols) {
    const stockData = await fetchStockData(symbol);

    if (stockData) {
      const { dates, prices } = transformStockData(stockData);

      // Create stock chart
      createStockChart(symbol, dates, prices);
    }
  }
}

main();
  </script>
</body>
</html>
